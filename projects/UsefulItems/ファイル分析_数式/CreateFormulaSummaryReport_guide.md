# CreateFormulaSummaryReport 使い方ガイド

## 概要

- モジュール `ModFormulaReport` に含まれるマクロ `CreateFormulaSummaryReport` は、ブック内のすべてのワークシートを巡回して「数式が入力されているセル」を一覧化します。
- 出力シートは自動的に生成され、レポート名は固定で「数式一覧」を利用します。元のシートは一切変更しません。
- 数式の内容だけでなく、セルの表示形式や実際の表示値も確認できるので、初心者の方でも安心してチェック作業に活用できます。

## 出力される列

| 列 | 見出し | 内容 | 補足 |
| --- | --- | --- | --- |
| A列 | シート名 | 数式が見つかったシートを表示します。 | クリックすると元シートに移動できます。 |
| B列 | セル | 対象セルのアドレス（行列）です。 | 絶対参照ではなく相対表記（例: `B5`）。 |
| C列 | 表示値(書式適用) | 対象セルを参照する式（`='シート'!B5`）を設定し、元のセルと同じ表示形式をそのまま適用します。 | 色や桁区切りなどのフォーマットを再現します。 |
| D列 | FORMULATEXT結果 | `=FORMULATEXT('シート'!B5)` を設定し、元セルに入力された数式をテキストで表示します。 | 数式の確認・コピーに便利です。 |
| E列 | セル値(コピー) | 元セルの値を「値貼り付け」と同じ形で転記します。 | 数式結果を固定値として保存したい場合に利用できます。 |

> **ポイント**: C列が元セルと同じ装飾で値を表示し、D列がそのセルの数式文字列を示す構成になっています。視覚とテキストの両面から確認できます。

## 操作手順（初心者向け）

1. レポートを作成したい Excel ファイルを開き、マクロが有効な形式 (`.xlsm` など) で保存しておきます。
2. `Alt + F11` を押して VBA エディターを開き、プロジェクト エクスプローラーで `Modules` 内の `ModFormulaReport` をダブルクリックします。
3. エディターのメニューから `実行` → `Sub/UserForm の実行` を選び、一覧から `CreateFormulaSummaryReport` を選択して `実行` をクリックします。ショートカット `F5` でも実行できます。
4. 数秒待つと、新しいシート「数式一覧」が追加されます。ここに全シート分の数式情報がまとめられます。
5. 気になる行をクリックすると、B列とシート名を手がかりに元セルへジャンプして検証作業を進められます。

## 活用アイデア

- **レビュー前チェック**: 共有前にレポートを走らせ、意図しない手入力や未設定セルが紛れていないか確認します。
- **仕様書代わり**: FORMULATEXT の結果をそのまま仕様メモとして流用できます。
- **差分比較**: レポートを CSV に書き出してバージョン管理すれば、数式変更点の追跡が容易になります。

## トラブルシューティング

| 症状 | 対処方法 |
| --- | --- |
| レポートが空欄になる | ブック内に数式セルが無い場合は空になります。セルが計算結果のみになっていないか確認してください。 |
| D列が `#N/A` になる | `FORMULATEXT` は Excel 2013 以降で利用できます。バージョンを確認してください。また、参照先が保護されていると表示できないことがあります。 |
| C列と元セルの表示が違う | 元セルの表示形式 (`NumberFormatLocal`) が特殊書式になっていないか確認し、必要に応じて元セルの設定を調整してください。 |
| シート「数式一覧」が既にある | マクロ実行時に既存の同名シートは自動で削除されます。必要なデータは事前にバックアップしてください。 |

## 更新履歴

- 2025-10-04: C列を書式付き参照、D列に `FORMULATEXT`、E列に値コピーを追加。
- 2025-09-25: 初版作成。
