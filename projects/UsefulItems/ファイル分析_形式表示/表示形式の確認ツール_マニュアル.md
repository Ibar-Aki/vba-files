# 表示形式の確認ツール 取扱説明書

## 概要
- 対象ブックに設定されているセルの表示形式を一覧化し、件数順に確認できる補助ツールです。
- 実行マクロ名：`ListAllNumberFormats`（標準モジュール「表示形式の確認ツール.bas」に収録）。
- 出力結果は同一ブック内のシート「表示形式一覧」に自動でまとめられます。

## 動作環境
- Microsoft Excel 2016 以降（Windows版）。
- 表示形式を調べたいブックがマクロ有効形式（.xlsm など）で保存されていること。

## 事前準備
1. Excel で対象ブックを開きます。
2. `Alt + F11` で VBA エディターを開き、プロジェクト内に「表示形式の確認ツール.bas」がインポートされていることを確認します。
3. セキュリティ設定でマクロが実行できる状態にしておきます。

## 操作手順
1. VBA エディター、または Excel 画面に戻り `Alt + F8` を押して「マクロ」ダイアログを開きます。
2. 一覧から `ListAllNumberFormats` を選択し、「実行」をクリックします。
3. 処理が完了すると、シート「表示形式一覧」が前面に表示され、集計結果が確認できます。

## 出力内容（シート「表示形式一覧」）
- 列A：連番。
- 列B：NumberFormatLocal を基にした表示形式文字列。
- 列C：推定カテゴリ（数値、日付、文字列など）。
- 列D：同じ表示形式が設定されているセルの件数。
- 列E：代表セルの一覧（最大20件）。縦横に連続するセルは `C1:C3` や `A1:C1` のように範囲で表示し、矩形に並ぶセルは `A1:B2` のようにまとめて表示します。

## 補足・ヒント
- 代表セルは最大20件まで収集されるため、同じ書式でも複数の位置を把握できます。
- 代表セルのアドレスはシート名付きで表示されるため、該当セルへジャンプしやすくなっています。
- 集計後にフィルターや並べ替えを追加で設定すると、目的の表示形式を素早く探せます。
- 処理対象が大きいブックでは、完了メッセージが表示されるまで数十秒程度かかる場合があります。
