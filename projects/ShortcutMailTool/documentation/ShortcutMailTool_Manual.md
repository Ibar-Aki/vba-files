# ShortcutMailTool 取扱説明書

## 1. このツールについて
ShortcutMailTool は、Excel 上で定型メールの宛先や本文を一覧から選び、ワンクリックでクリップボードにコピーできるマクロです。

## 2. 必要なファイル
- Excel マクロブック（例: sample_data.xlsm）
- データ一覧ファイル `sample_data.csv`

両方を同じフォルダーに保存してください。

## 3. 初めて使う前の準備
1. Excel でブックを開き、上部のメッセージバーに「セキュリティの警告」が表示されたら **「コンテンツの有効化」** をクリックします。
2. ブックを一度閉じて、再度開きます。Windows のクリップボード機能が正しく働きやすくなります。
3. ファイルを共有している場合は、読み取り専用にすると他の人が誤って上書きしないので安心です。

## 4. CSV ファイルの書き方
- 文字コードは **UTF-8** で保存します。（Shift_JIS でも動作しますが、UTF-8 を推奨します。）
- 1 行目は必ず `Label,Content` と入力してください。
- 2 行目以降には、画面に表示したい名前（Label）と実際にコピーしたい内容（Content）をカンマで区切って記入します。

例:
```
Label,Content
サポート窓口,support@example.com
会議案内,明日は10時から会議があります。
```

カンマを含む文章は、対象の行全体をダブルクォーテーション `"` で囲むと確実です。

## 5. 使い方
1. Excel でブックを開いた状態で、キーボードの **Alt + F8** を押します。
2. マクロ一覧から **ShowShortcutMailMenu** を選び、「実行」をクリックします。
3. 画面に番号付きのメニューが表示されたら、コピーしたい項目の番号を入力します。
4. メッセージが閉じたらコピー完了です。メールやチャットで **Ctrl + V** を押して貼り付けてください。

## 6. 履歴の更新方法
1. `sample_data.csv` をメモ帳などのテキストエディタで開きます。
2. 追加・修正したい行を編集します。
3. 上書き保存したら Excel に戻り、再度マクロを実行するだけで反映されます。

## 7. トラブルが起きたときは
| 症状 | 確認ポイント |
| --- | --- |
| 「CSV ファイルが見つかりません」 | ブックと CSV が同じフォルダーにあるか、ファイル名が正しいか確認します。 |
| 「データが読み込めませんでした」 | CSV の1行目が `Label,Content` になっているか、空行やカンマ不足がないか確認します。 |
| 「メモリが不足しています」 | Excel や他のクリップボード監視ソフトを一度閉じ、PC を再起動します。リモートデスクトップ利用時は接続を再開して試してください。 |
| 文字化けする | CSV を UTF-8 で保存し直し、Excel で再度マクロを実行します。 |

## 8. 困ったときの連絡
上記の確認でも解決しない場合は、以下の情報をメモして管理者に連絡してください。
- 発生したエラーメッセージ
- 操作した手順
- 使用している Excel のバージョンと Windows のバージョン
