# Excel結合ツール かんたん利用ガイド

**このガイドの対象者**: パソコン初心者の方  
**所要時間**: 初回セットアップ約15分、通常使用は1分以内

---

## 📌 このツールでできること

**2つのExcelファイルを1つにまとめます。**

例えば：

- 「顧客リスト.xlsx」と「売上データ.xlsx」を
- 共通の顧客コードで結合して
- 「結合データ.xlsx」として出力

---

## 🎯 使い方（3ステップ）

### ステップ1: 結合したいファイルを用意する

2つのExcelファイルを用意します。

```
例：
📄 顧客マスタ.xlsx   ← 顧客コードと顧客名が入ったファイル
📄 売上データ.xlsx   ← 顧客コードと売上金額が入ったファイル
```

> **💡 ポイント**: 両方のファイルに「顧客コード」のような**共通の項目**が必要です。

---

### ステップ2: ファイルを選んでドラッグ＆ドロップ

1. **2つのExcelファイルを選択**
   - 1つ目のファイルをクリック
   - **Ctrlキーを押しながら**2つ目のファイルをクリック
   - 2つとも青く選択された状態になります

2. **Start.batにドラッグ＆ドロップ**
   - 選択した2つのファイルを
   - `batch` フォルダ内の **Start.bat** の上に
   - マウスで引っ張って離します

![ドラッグ＆ドロップのイメージ](ドラッグ操作の説明図)

---

### ステップ3: 結果を確認する

1. 黒い画面（コマンドプロンプト）が表示されます
2. 「処理が完了しました」と表示されたら成功です
3. **何かキーを押す**と画面が閉じます
4. **Output** フォルダに結果ファイルが作成されています

```
📁 Output/
   └── 📄 結合データ_20260108_011712.xlsx  ← これが結果です！
```

---

## ❌ うまくいかないとき

### 「マクロが無効です」と表示される

**原因**: Excelのセキュリティ設定でマクロがブロックされています。

**解決方法**:

1. Excelを開く
2. **ファイル** → **オプション** をクリック
3. 左側の **トラストセンター** をクリック
4. **トラストセンターの設定** ボタンをクリック
5. 左側の **マクロの設定** をクリック
6. **警告を表示してすべてのマクロを無効にする** を選択
7. **OK** を2回クリック

---

### 「ファイルが見つかりません」と表示される

**原因**: ファイルの場所に問題があります。

**解決方法**:

- ファイル名やフォルダ名に**特殊な記号**（`& % #`など）が含まれていませんか？
- ファイルが**ネットワークドライブ**にありませんか？
  → パソコンのローカル（Cドライブなど）にコピーしてお試しください

---

### 「処理中にエラーが発生しました」と表示される

**原因**: 設定とファイルの内容が合っていません。

**確認すること**:

1. 結合したいファイルは**Excel形式**（.xlsx, .xls）ですか？
2. 両方のファイルに**共通の識別コード列**がありますか？
3. ファイルが**他のプログラムで開かれていませんか**？
   → Excelで開いている場合は閉じてください

---

## 📊 結果ファイルの見方

結果のExcelファイルには2つのシートがあります：

| シート名 | 内容 |
|----------|------|
| **結合データ** | マージされたデータ本体 |
| **処理ログ** | 処理結果のレポート（件数など） |

### 処理ログシートの読み方

```
Excel1データ件数:     100 件  ← 1つ目のファイルの行数
Excel2データ件数:     80 件   ← 2つ目のファイルの行数
結合済みデータ件数:   75 件   ← 両方に存在したデータ
Excel1のみデータ件数: 25 件   ← 1つ目だけにあったデータ
Excel2のみデータ件数: 5 件    ← 2つ目だけにあったデータ
```

---

## 🔧 設定を変更したいとき

設定は **Config** フォルダの **MergeConfig.xlsx** で変更できます。

### よくある変更

| やりたいこと | 変更する設定項目 | 例 |
|-------------|-----------------|-----|
| 識別コードの列を変える | Excel1_IDColumn / Excel2_IDColumn | A, B, C... |
| ヘッダー行数を変える | Excel1_HeaderRows / Excel2_HeaderRows | 1, 2, 3... |

> **⚠️ 注意**: 設定を変更したら、ファイルを**保存して閉じて**から使ってください。

---

## 📞 困ったときは

1. まず、このガイドの「うまくいかないとき」を確認
2. `Output` フォルダの結果ファイルにある「処理ログ」シートを確認
3. それでも解決しない場合は、システム管理者にご連絡ください

---

## 📝 用語集

| 用語 | 意味 |
|------|------|
| **ドラッグ＆ドロップ** | マウスでつかんで、別の場所に落とす操作 |
| **識別コード** | 両方のファイルで共通している項目（顧客コードなど） |
| **ヘッダー行** | データの一番上にある項目名の行 |
| **.xlsx** | Excelファイルの種類 |
| **マクロ** | Excelの中で動く自動処理プログラム |

---

**最終更新**: 2026年1月8日
