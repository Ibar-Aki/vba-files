# 罫線抽出マクロ 利用ガイド (v3)

Excel シートから罫線情報を抽出し、一覧表示するマクロです。

## ファイル

- `BorderExtractor.bas` (UTF-8)
- `BorderExtractor_SJIS.bas` (Shift_JIS) - **日本語 Windows 環境推奨**

## インポート方法

1. Excel ファイルを開く
2. `Alt + F11` で VBA エディタを開く
3. `ファイル` > `ファイルのインポート...` で `BorderExtractor_SJIS.bas` を選択

> [!TIP]
> 日本語の文字化けを防ぐため、SJIS 版を使用してください。

## 実行方法

1. 分析したいシートに移動
2. `Alt + F8` でマクロダイアログを開く
3. `ExtractBorderInfo` を選択し、**実行**
4. **範囲選択ダイアログ**が表示されるので、処理範囲を選択して OK

> [!IMPORTANT]
> 大きなシートでは、必要な範囲だけを選択することでフリーズを防止できます。

## v3 の新機能

- **範囲選択ダイアログ**: 処理範囲を自分で指定可能
- **進捗表示**: ステータスバーに処理状況を表示
- **キャンセル対応**: 処理中に `Esc` キーで中断可能

## 出力

`Border_[タイムスタンプ]` という新しいシートに以下が出力されます：

| 列名 | 説明 |
|------|------|
| セル番地 | 罫線の位置（結合セルは左上のみ） |
| 罫線位置 | 左、上、下、右、斜線 |
| 線種 | 実線、点線、二重線など |
| 太さ | 極細、細、中、太 |
| 色 | 黒(自動)、赤、青など |
| カラーインデックス | パレットのインデックス |

## 出力例

| セル番地 | 罫線位置 | 線種 | 太さ | 色 |
|----------|----------|------|------|------|
| B2 | 下 | 実線 | 細 | 黒(自動) |
